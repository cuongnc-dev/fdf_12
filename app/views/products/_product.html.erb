<div class="product_item_wrapper col-md-3 margin-top-5-bot-5 item-produc-shop padding-left_domain">
  <div class="product_content_area">
    <div class="image_product">
      <% if @domain.present? %>
        <% if current_user.is_member_of_domain? @domain %>
          <%= link_to domain_product_path(@domain, product) do %>
            <%= image_tag product.image.url,
              class: "image-shop height-27375 img_cover_size image_product_item" %>
          <% end %>
        <% else %>
          <%= link_to "#join-domain-order-#{product.id}", "data-toggle": "modal" do %>
            <%= image_tag product.image.url,
              class: "image-shop height-27375 img_cover_size image_product_item" %>
          <% end %>
        <% end %>
      <% else %>
        <%= link_to product_path(product, domain_id: "not_find") do %>
          <%= image_tag product.image.url,
            class: "image-shop height-27375 img_cover_size image_product_item" %>
        <% end %>
      <% end %>
      <h3>
        <%= t "cart.order_time_text" %>
        <%= l product.start_hour, format: :short_time %>
        <%= t "split" %>
        <%= l product.end_hour, format: :short_time %>
      </h3>
    </div>
  </div>
  <div class="padding-10">
    <div class="description_area row">
      <div class="col-md-4 padding-left--10px">
        <% if @domain.present? %>
          <% if current_user.is_member_of_domain? @domain %>
            <%= link_to domain_product_path(@domain, product) do %>
              <span class="shop-avatar">
                <% if product.shop_avatar.nil? %>
                  <%= image_tag "default_shop_avatar", class: "image_shop_icon_product_item" %>
                <% else %>
                  <%= image_tag product.shop_avatar.url,
                    class: "image_shop_icon_product_item present" %>
                <% end %>
              </span>
            <% end %>
            <div class="shop_nam_item_product">
              <strong class="truncate-12em">
                <%= link_to truncate(product.shop.name,
                  length: Settings.max_shop_name),
                  domain_shop_path(@domain, product.shop),
                  class: "tooltips", title: product.shop.name %>
              </strong>
            </div>
          <% else %>
            <%= link_to "#user-need-join-domain-#{product.shop.id}",
              "data-toggle": "modal" do %>
              <span class="shop-avatar">
                <% if product.shop_avatar.nil? %>
                  <%= image_tag "default_shop_avatar", class: "image_shop_icon_product_item" %>
                <% else %>
                  <%= image_tag product.shop_avatar.url,
                    class: "image_shop_icon_product_item present" %>
                <% end %>
              </span>
            <% end %>
            <div class="shop_nam_item_product">
              <strong class="truncate-12em">
                <%= link_to truncate(product.shop.name,
                  length: Settings.max_shop_name),
                  "#user-need-join-domain-#{product.shop.id}",
                  class: "tooltips", title: product.shop.name,
                  "data-toggle": "modal" %>
              </strong>
            </div>
          <% end %>
        <% end %>
      </div>
      <% if @domain.present? %>
        <div class="col-md-8">
          <div>
          </div>
          <div class="product_text truncate name_product_in_shop",
            title="<%= product.name %>">
            <strong><%= truncate(product.name,
              length: Settings.max_shop_name) %></strong>
          </div>
          <div class="product_text product_price">
            <h4><%= format_price product.price %></h4>
          </div>
        </div>
      <% end %>
    </div>
    <% if !(current_user.domains.include? @domain) %>
      <div class="interaction_area">
        <% if Time.now.is_between_short_time?(product.start_hour,
          product.end_hour) || !product.shop.active? ||
          product.shop.status_on_off == Settings.shop_status_off %>
          <%= link_to t("blank_link"), class: "btn btn_add_to_cart btn-add
            padding-left-for-button disabled" do %>
            <span class="glyphicon glyphicon-shopping-cart"></span>
            <%= t "cart.add_to_card" %>
          <% end %>
        <% else %>
          <% if current_user.is_member_of_domain? @domain %>
            <%= link_to cart_path(product.id), remote: true,
              method: :put, class: "btn btn_add_to_cart btn-add padding-left-for-button" do %>
              <span class="glyphicon glyphicon-shopping-cart"></span>
              <%= t "cart.add_to_card" %>
            <% end %>
          <% else %>
            <%= link_to t("blank_link"), class: "btn btn_add_to_cart btn-add
              padding-left-for-button disabled" do %>
              <span class="glyphicon glyphicon-shopping-cart"></span>
              <%= t "cart.add_to_card" %>
            <% end %>
          <% end %>
        <% end %>
        <div id="join-domain-order-<%= product.id %>" class="modal fade">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header modal_header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                  &times;
                </button>
                <h4 class="modal-title modal_text_header"><%= t "common.notifications" %></h4>
              </div>
              <div class="modal-body confirm-body">
                <h4><%= t "user_need_join_domain_product",
                  domain_name: @domain.name, product_name: product.name %>
                </h4>
                <h4><%= t "click_to_join_domain" %></h4>
              </div>
              <div class="modal-footer">
                <%= link_to t("common.btn_ok"), user_domains_path(user_id: current_user.id,
                  domain_id: @domain.id, join_domain: true), method: :post,
                  class: "btn btn-success" %>
                <%= link_to t("cancel"), "#", "data-dismiss": "modal",
                  class: "btn btn-default" %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% else %>
      <div class="interaction_area">
        <div class="group_button">
          <% if Time.now.is_between_short_time?(product.start_hour,
            product.end_hour) || !product.shop.active? ||
            product.shop.status_on_off == Settings.shop_status_off %>
            <%= link_to t("blank_link"), class: "btn btn_add_to_cart btn-add
              padding-left-for-button disabled btn_center" do %>
              <span class="glyphicon glyphicon-shopping-cart"></span>
              <%= t "cart.add_to_card" %>
            <% end %>
            <%= link_to t("blank_link"), class: "btn btn_add_to_cart btn-add
              padding-left-for-button disabled btn_center" do %>
              <span class="glyphicon glyphicon glyphicon-check"></span>
              <%= t "cart_quick.order_now" %>
            <% end %>
          <% else %>
            <%= link_to cart_path(product.id), remote: true,
              method: :put, class: "btn btn_add_to_cart btn-add
              padding-left-for-button btn_center" do %>
              <span class="glyphicon glyphicon-shopping-cart"></span>
              <%= t "cart.add_to_card" %>
            <% end %>
            <%= link_to "#modal_order_now", data: {toggle: "modal", product: product},
              class: "btn btn_add_to_cart btn-add padding-left-for-button
              btn_modal_order_now btn_center" do %>
              <span class="glyphicon glyphicon glyphicon-check"></span>
              <%= t "cart_quick.order_now" %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
